---
interface Props {
  title: string;
  href: string;
  date?: Date;
  description?: string;
  tags?: string[];
  index?: number;
  // Recipe-specific optional fields
  prepTime?: string;
  cookTime?: string;
  servings?: number;
  difficulty?: 'easy' | 'medium' | 'hard';
}

const { title, href, date, description, tags, index = 0, prepTime, cookTime, servings, difficulty } = Astro.props;
const isRecipe = prepTime || cookTime || servings || difficulty;
const formattedDate = date?.toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});

// Calculate animation delay based on index
const animationDelay = `${index * 0.1}s`;

// Difficulty badge colors
const difficultyColors: Record<string, string> = {
  easy: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400',
  medium: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400',
  hard: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400'
};
---

<article
  class="group relative p-6 rounded-xl bg-white dark:bg-surface-dark border border-cream-300 dark:border-border-dark shadow-card dark:shadow-card-dark hover:shadow-card-hover dark:hover:shadow-card-dark-hover transition-all duration-300 ease-out hover:-translate-y-1 animate-fade-up"
  style={`animation-delay: ${animationDelay}; opacity: 0;`}
>
  <!-- Architectural corner accent -->
  <div class="absolute top-3 left-3 w-4 h-4 border-l-2 border-t-2 border-accent/30 dark:border-gold/30 group-hover:border-accent dark:group-hover:border-gold transition-colors duration-300"></div>
  <div class="absolute bottom-3 right-3 w-4 h-4 border-r-2 border-b-2 border-accent/30 dark:border-gold/30 group-hover:border-accent dark:group-hover:border-gold transition-colors duration-300"></div>

  <a href={href} class="block">
    <!-- Date with elegant styling -->
    {date && (
      <div class="mb-3 flex items-center gap-2">
        <div class="w-8 h-px bg-accent dark:bg-gold"></div>
        <time
          datetime={date.toISOString()}
          class="text-xs tracking-widest uppercase font-medium text-ink-muted dark:text-cream-400"
        >
          {formattedDate}
        </time>
      </div>
    )}

    <!-- Title with serif display font -->
    <h3 class="font-display text-xl font-semibold text-primary-800 dark:text-cream-100 group-hover:text-accent-600 dark:group-hover:text-gold transition-colors duration-200 mb-3 leading-tight">
      {title}
    </h3>

    <!-- Description -->
    {description && (
      <p class="text-ink-light dark:text-cream-300 leading-relaxed mb-4 line-clamp-2">
        {description}
      </p>
    )}

    <!-- Recipe metadata -->
    {isRecipe && (
      <div class="flex flex-wrap items-center gap-3 mb-4 text-xs text-ink-muted dark:text-cream-400">
        {prepTime && (
          <span class="flex items-center gap-1">
            <span class="material-symbols-outlined text-sm text-accent dark:text-gold">timer</span>
            {prepTime}
          </span>
        )}
        {cookTime && (
          <span class="flex items-center gap-1">
            <span class="material-symbols-outlined text-sm text-accent dark:text-gold">local_fire_department</span>
            {cookTime}
          </span>
        )}
        {servings && (
          <span class="flex items-center gap-1">
            <span class="material-symbols-outlined text-sm text-accent dark:text-gold">group</span>
            {servings} servings
          </span>
        )}
        {difficulty && (
          <span class={`px-2 py-0.5 rounded-full text-xs font-medium ${difficultyColors[difficulty]}`}>
            {difficulty.charAt(0).toUpperCase() + difficulty.slice(1)}
          </span>
        )}
      </div>
    )}

    <!-- Tags with refined styling -->
    {tags && tags.length > 0 && (
      <div class="flex flex-wrap gap-2 pt-4 border-t border-cream-200 dark:border-border-dark">
        {tags.map(tag => (
          <span class="inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-primary-50 dark:bg-navy-800 text-primary-700 dark:text-gold-400 border border-primary-100 dark:border-border-dark">
            {tag}
          </span>
        ))}
      </div>
    )}
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
